---
layout: post
title: 亲爱的Python老弟
categories: Python
description: 记录我和Python老弟的点点滴滴
keywords: Python
---

记录我和Python老弟的点点滴滴

#### demo之爬小说(注意各行缩进)
```
from android.app import Service
from android.os import IBinder
from android.content import Intent
from android.support.annotation import Nullable
from java import Override, static_proxy
from bs4 import BeautifulSoup
import requests
import os

class PBookService(static_proxy(Service)):
    @Nullable
    @Override(IBinder, [Intent])
    def onBind(self, intent):
        return null
    @Override(int, [Intent, int, int])
    def onStartCommand(self, intent, flags, startId):
        return Service.onStartCommand(self, intent, flags, startId)
 self.url = 'http://www.xbiquge.la/10/'
        self.names = []#存放章节名称
        self.hrefs = []#存放章节链接
        self.book = '10489'
        self.get_urlandname()
        self.path = "/sdcard/mypynovels"
        self.mkdir(self.path)
        for i in range(len(self.names)):
            name = self.names[i]
            text = str(self.get_text(self.hrefs[i]))
            os.chdir(self.path)
            print(os.getcwd())
            self.writer(name,"xs.txt",text)
  @Override(IBinder, [Intent])
    def onBind(self, intent):
        return null

        @Override(int,[Intent,int,int])
        def onStartCommand(self,intent,flags,startId):
            print("开始执行")
            self.url = 'http://www.xbiquge.la/10/'
            self.names = []#存放章节名称
            self.hrefs = []#存放章节链接
            self.book = '10489'
            self.get_urlandname()
            self.path = "/sdcard/mypynovels"
            self.mkdir(self.path)
            for i in range(len(self.names)):
                name = self.names[i]
                text = str(self.get_text(self.hrefs[i]))
                os.chdir(self.path)
                print(os.getcwd())
                self.writer(name,"xs.txt",text)
            return Service.onStartCommand(self,intent,flags.startId)

        def get_urlandname(self):
            response = requests.get(url=self.url + self.book )
            response.encoding='utf-8'
            req_parser = BeautifulSoup(response.text,"html.parser")
            dd = req_parser.find_all('dd')
            a_bf = BeautifulSoup(str(dd))
            a = a_bf.find_all('a')
            for i in a:
                self.names.append(i.string)#str只获取指定的文本类型
                self.hrefs.append(self.url + i['href'][4:])
            #print(self.names)
            #print(self.hrefs)
        def get_text(self,url):
            respons2 =requests.get(url=url)
            respons2.encoding='utf-8'
            c = BeautifulSoup(str(respons2.text),'html.parser')
            b = c.find_all('div', id='content')
            text = []
            for temp in  b:#获取标签里面的文本只能进行遍历每个满足条件的文本才能获取
                text.append(temp)
                txt = str(text)
            return txt.replace("<br/>","")[19:-179]
        def writer(self,name,path,text1):
            ''' 写入TXT文档'''
            with open(path,'a',encoding='utf-8') as f:
                f.write(name + '\n')#写入名字并换行
                f.writelines(text1)#追加内容
                f.write('\n\n')#换两行
        def mkdir(self,path):
            #去除首尾空格
            path = path.strip()
            # 去除尾部 \ 符号
            path = path.rstrip("\\")
            # 判断路径是否存在
            # 存在     True
            # 不存在   False
            isExists = os.path.exists(path)
            # 判断结果
            if not isExists:
                # 如果不存在则创建目录
                # 创建目录操作函数
                os.makedirs(path)
                print(path + ' 创建成功')
                return True
            else:
                # 如果目录存在则不创建，并提示目录已存在
                print(path + ' 目录已存在')
                return False
```

